#!/bin/bash
set -o nounset
source "$( dirname "$(readlink -f "$0")" )/_variables"


function die {
   echo "$1">&2
   exit 1
}

if [ "$#" -ne 1 ]; then die "Usage:   ${SERVICENAME} configure PORT"; fi
PORT="$1"

docker run -i -t --name="${SERVICENAME}-run" ${DOCKEROPTS[@]} ${IMAGENAME} bash -c "echo -n $PORT > /config/port"
RVAL=$?
docker rm "${SERVICENAME}-run" >/dev/null 2>&1
if [ "$RVAL" -ne 0 ]; then die "Failed to configure minecraft on port $PORT :(" ; fi
exit "$RVAL"
